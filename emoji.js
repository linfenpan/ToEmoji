;
! function(window, NAME) {

    var maxLen = 189;
    var className = NAME.slice(0, 1).toLowerCase() + NAME.slice(1, -1);

    // å›¾ç‰‡æ¨¡æ¿
    var imageTmp = '<img class="' + className + '" src="';

    // éº»çƒ¦æŠŠè·¯å¾„å†™æ­»äº†!!
    var path = "./images/";

    var emoji = {
        length: maxLen,
        /**
         * åˆå§‹åŒ– emoji è¡¨æƒ…æ”¾ç½®çš„åŸºç¡€è·¯å¾„ï¼Œä¸è®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼
         * åŒæ—¶ï¼Œåˆå§‹åŒ– emoji è¡¨æƒ…çš„é…ç½®
         * @param {String?} basePath åŸºç¡€è·¯å¾„
         * @param {Object} config    emojiè¡¨æƒ…è·¯å¾„é…ç½®
         */
        init: function(basePath, config) {
            basePath && (path = basePath);
            this._emoji = config || {
                "01": {
                    "key": "ğŸ˜„"
                },
                "02": {
                    "key": "ğŸ˜ƒ"
                },
                "03": {
                    "key": "ğŸ˜€"
                },
                "04": {
                    "key": "ğŸ˜Š"
                },
                "05": {
                    "key": "â˜º"
                },
                "06": {
                    "key": "ğŸ˜‰"
                },
                "07": {
                    "key": "ğŸ˜"
                },
                "08": {
                    "key": "ğŸ˜˜"
                },
                "09": {
                    "key": "ğŸ˜š"
                },
                "10": {
                    "key": "ğŸ˜—"
                },
                "11": {
                    "key": "ğŸ˜™"
                },
                "12": {
                    "key": "ğŸ˜œ"
                },
                "13": {
                    "key": "ğŸ˜"
                },
                "14": {
                    "key": "ğŸ˜›"
                },
                "15": {
                    "key": "ğŸ˜³"
                },
                "16": {
                    "key": "ğŸ˜"
                },
                "17": {
                    "key": "ğŸ˜”"
                },
                "18": {
                    "key": "ğŸ˜Œ"
                },
                "19": {
                    "key": "ğŸ˜’"
                },
                "20": {
                    "key": "ğŸ˜"
                },
                "21": {
                    "key": "ğŸ˜£"
                },
                "22": {
                    "key": "ğŸ˜¢"
                },
                "23": {
                    "key": "ğŸ˜‚"
                },
                "24": {
                    "key": "ğŸ˜­"
                },
                "25": {
                    "key": "ğŸ˜ª"
                },
                "26": {
                    "key": "ğŸ˜¥"
                },
                "27": {
                    "key": "ğŸ˜°"
                },
                "28": {
                    "key": "ğŸ˜…"
                },
                "29": {
                    "key": "ğŸ˜“"
                },
                "30": {
                    "key": "ğŸ˜©"
                },
                "31": {
                    "key": "ğŸ˜«"
                },
                "32": {
                    "key": "ğŸ˜¨"
                },
                "33": {
                    "key": "ğŸ˜±"
                },
                "34": {
                    "key": "ğŸ˜ "
                },
                "35": {
                    "key": "ğŸ˜¡"
                },
                "36": {
                    "key": "ğŸ˜¤"
                },
                "37": {
                    "key": "ğŸ˜–"
                },
                "38": {
                    "key": "ğŸ˜†"
                },
                "39": {
                    "key": "ğŸ˜‹"
                },
                "40": {
                    "key": "ğŸ˜·"
                },
                "41": {
                    "key": "ğŸ˜"
                },
                "42": {
                    "key": "ğŸ˜´"
                },
                "43": {
                    "key": "ğŸ˜µ"
                },
                "44": {
                    "key": "ğŸ˜²"
                },
                "45": {
                    "key": "ğŸ˜Ÿ"
                },
                "46": {
                    "key": "ğŸ˜¦"
                },
                "47": {
                    "key": "ğŸ˜§"
                },
                "48": {
                    "key": "ğŸ˜ˆ"
                },
                "49": {
                    "key": "ğŸ‘¿"
                },
                "50": {
                    "key": "ğŸ˜®"
                },
                "51": {
                    "key": "ğŸ˜¬"
                },
                "52": {
                    "key": "ğŸ˜"
                },
                "53": {
                    "key": "ğŸ˜•"
                },
                "54": {
                    "key": "ğŸ˜¯"
                },
                "55": {
                    "key": "ğŸ˜¶"
                },
                "56": {
                    "key": "ğŸ˜‡"
                },
                "57": {
                    "key": "ğŸ˜"
                },
                "58": {
                    "key": "ğŸ˜‘"
                },
                "59": {
                    "key": "ğŸ‘²ğŸ¿"
                },
                "60": {
                    "key": "ğŸ‘³ğŸ¿"
                },
                "61": {
                    "key": "ğŸ‘®ğŸ¿"
                },
                "62": {
                    "key": "ğŸ‘·ğŸ¿"
                },
                "63": {
                    "key": "ğŸ’‚ğŸ¿"
                },
                "64": {
                    "key": "ğŸ‘¶ğŸ¿"
                },
                "65": {
                    "key": "ğŸ‘¦ğŸ¿"
                },
                "66": {
                    "key": "ğŸ‘§ğŸ¿"
                },
                "67": {
                    "key": "ğŸ‘¨ğŸ¿"
                },
                "68": {
                    "key": "ğŸ‘©ğŸ¿"
                },
                "69": {
                    "key": "ğŸ‘´ğŸ¿"
                },
                "70": {
                    "key": "ğŸ‘µğŸ¿"
                },
                "71": {
                    "key": "ğŸ‘±ğŸ¿"
                },
                "72": {
                    "key": "ğŸ‘¼ğŸ¿"
                },
                "73": {
                    "key": "ğŸ‘¸ğŸ¿"
                },
                "74": {
                    "key": "ğŸ˜º"
                },
                "75": {
                    "key": "ğŸ˜¸"
                },
                "76": {
                    "key": "ğŸ˜»"
                },
                "77": {
                    "key": "ğŸ˜½"
                },
                "78": {
                    "key": "ğŸ˜¼"
                },
                "79": {
                    "key": "ğŸ™€"
                },
                "80": {
                    "key": "ğŸ˜¿"
                },
                "81": {
                    "key": "ğŸ˜¹"
                },
                "82": {
                    "key": "ğŸ˜¾"
                },
                "83": {
                    "key": "ğŸ‘¹"
                },
                "84": {
                    "key": "ğŸ‘º"
                },
                "85": {
                    "key": "ğŸ™ˆ"
                },
                "86": {
                    "key": "ğŸ™‰"
                },
                "87": {
                    "key": "ğŸ™Š"
                },
                "88": {
                    "key": "ğŸ’€"
                },
                "89": {
                    "key": "ğŸ‘½"
                },
                "90": {
                    "key": "ğŸ’©"
                },
                "91": {
                    "key": "ğŸ”¥"
                },
                "92": {
                    "key": "âœ¨"
                },
                "93": {
                    "key": "ğŸŒŸ"
                },
                "94": {
                    "key": "ğŸ’«"
                },
                "95": {
                    "key": "ğŸ’¥"
                },
                "96": {
                    "key": "ğŸ’¢"
                },
                "97": {
                    "key": "ğŸ’¦"
                },
                "98": {
                    "key": "ğŸ’§"
                },
                "99": {
                    "key": "ğŸ’¤"
                },
                "100": {
                    "key": "ğŸ’¨"
                },
                "101": {
                    "key": "ğŸ‘‚ğŸ¿"
                },
                "102": {
                    "key": "ğŸ‘€"
                },
                "103": {
                    "key": "ğŸ‘ƒğŸ¿"
                },
                "104": {
                    "key": "ğŸ‘…"
                },
                "105": {
                    "key": "ğŸ‘„"
                },
                "106": {
                    "key": "ğŸ‘ğŸ¿"
                },
                "107": {
                    "key": "ğŸ‘ğŸ¿"
                },
                "108": {
                    "key": "ğŸ‘ŒğŸ¿"
                },
                "109": {
                    "key": "ğŸ‘ŠğŸ¿"
                },
                "110": {
                    "key": "âœŠğŸ¿"
                },
                "111": {
                    "key": "âœŒğŸ¿"
                },
                "112": {
                    "key": "ğŸ‘‹ğŸ¿"
                },
                "113": {
                    "key": "âœ‹ğŸ¿"
                },
                "114": {
                    "key": "ğŸ‘ğŸ¿"
                },
                "115": {
                    "key": "ğŸ‘†ğŸ¿"
                },
                "116": {
                    "key": "ğŸ‘‡ğŸ¿"
                },
                "117": {
                    "key": "ğŸ‘‰ğŸ¿"
                },
                "118": {
                    "key": "ğŸ‘ˆğŸ¿"
                },
                "119": {
                    "key": "ğŸ™ŒğŸ¿"
                },
                "120": {
                    "key": "ğŸ™ğŸ¿"
                },
                "121": {
                    "key": "â˜ğŸ¿"
                },
                "122": {
                    "key": "ğŸ‘ğŸ¿"
                },
                "123": {
                    "key": "ğŸ’ªğŸ¿"
                },
                "124": {
                    "key": "ğŸš¶ğŸ¿"
                },
                "125": {
                    "key": "ğŸƒğŸ¿"
                },
                "126": {
                    "key": "ğŸ’ƒğŸ¿"
                },
                "127": {
                    "key": "ğŸ‘«"
                },
                "128": {
                    "key": "ğŸ‘ª"
                },
                "129": {
                    "key": "ğŸ‘¬"
                },
                "130": {
                    "key": "ğŸ‘­"
                },
                "131": {
                    "key": "ğŸ’"
                },
                "132": {
                    "key": "ğŸ’‘"
                },
                "133": {
                    "key": "ğŸ‘¯"
                },
                "134": {
                    "key": "ğŸ™†ğŸ¿"
                },
                "135": {
                    "key": "ğŸ™…ğŸ¿"
                },
                "136": {
                    "key": "ğŸ’ğŸ¿"
                },
                "137": {
                    "key": "ğŸ™‹ğŸ¿"
                },
                "138": {
                    "key": "ğŸ’†ğŸ¿"
                },
                "139": {
                    "key": "ğŸ’‡ğŸ¿"
                },
                "140": {
                    "key": "ğŸ’…ğŸ¿"
                },
                "141": {
                    "key": "ğŸ‘°ğŸ¿"
                },
                "142": {
                    "key": "ğŸ™ğŸ¿"
                },
                "143": {
                    "key": "ğŸ™ğŸ¿"
                },
                "144": {
                    "key": "ğŸ™‡ğŸ¿"
                },
                "145": {
                    "key": "ğŸ©"
                },
                "146": {
                    "key": "ğŸ‘‘"
                },
                "147": {
                    "key": "ğŸ‘’"
                },
                "148": {
                    "key": "ğŸ‘Ÿ"
                },
                "149": {
                    "key": "ğŸ‘"
                },
                "150": {
                    "key": "ğŸ‘¡"
                },
                "151": {
                    "key": "ğŸ‘ "
                },
                "152": {
                    "key": "ğŸ‘¢"
                },
                "153": {
                    "key": "ğŸ‘•"
                },
                "154": {
                    "key": "ğŸ‘”"
                },
                "155": {
                    "key": "ğŸ‘š"
                },
                "156": {
                    "key": "ğŸ‘—"
                },
                "157": {
                    "key": "ğŸ½"
                },
                "158": {
                    "key": "ğŸ‘–"
                },
                "159": {
                    "key": "ğŸ‘˜"
                },
                "160": {
                    "key": "ğŸ‘™"
                },
                "161": {
                    "key": "ğŸ’¼"
                },
                "162": {
                    "key": "ğŸ‘œ"
                },
                "163": {
                    "key": "ğŸ‘"
                },
                "164": {
                    "key": "ğŸ‘›"
                },
                "165": {
                    "key": "ğŸ‘“"
                },
                "166": {
                    "key": "ğŸ€"
                },
                "167": {
                    "key": "ğŸŒ‚"
                },
                "168": {
                    "key": "ğŸ’„"
                },
                "169": {
                    "key": "ğŸ’›"
                },
                "170": {
                    "key": "ğŸ’™"
                },
                "171": {
                    "key": "ğŸ’œ"
                },
                "172": {
                    "key": "ğŸ’š"
                },
                "173": {
                    "key": "â¤"
                },
                "174": {
                    "key": "ğŸ’”"
                },
                "175": {
                    "key": "ğŸ’—"
                },
                "176": {
                    "key": "ğŸ’“"
                },
                "177": {
                    "key": "ğŸ’•"
                },
                "178": {
                    "key": "ğŸ’–"
                },
                "179": {
                    "key": "ğŸ’"
                },
                "180": {
                    "key": "ğŸ’˜"
                },
                "181": {
                    "key": "ğŸ’Œ"
                },
                "182": {
                    "key": "ğŸ’‹"
                },
                "183": {
                    "key": "ğŸ’"
                },
                "184": {
                    "key": "ğŸ’"
                },
                "185": {
                    "key": "ğŸ‘¤"
                },
                "186": {
                    "key": "ğŸ‘¥"
                },
                "187": {
                    "key": "ğŸ’¬"
                },
                "188": {
                    "key": "ğŸ‘£"
                },
                "189": {
                    "key": "ğŸ’­"
                }
            };

            // åˆå§‹åŒ–åï¼ŒåŠç§’å°±è‡ªåŠ¨å›æ”¶?
            var self = this;
            setTimeout(function() {
                self.destroy();
            }, 500);
        },
        /**
         * æŠŠå…ƒç´ å†…çš„emojiå­—ç¬¦ï¼Œæ›¿æ¢ä¸ºå›¾ç‰‡
         * @param {dom element} elem éœ€è¦æ›¿æ¢çš„å…ƒç´ 
         */
        emoji: function(elem) {
            // è€ƒè™‘åˆ°å¤§å®¶éƒ½å¾ˆæ‡’ï¼Œæ‰€ä»¥ï¼ŒåŠ ä¸€ä¸ªä¸€ä¸ªè‡ªåŠ¨åˆå§‹åŒ–çš„åˆ¤å®š
            if (!this._emoji) {
                this.init();
            }

            var html = elem.innerHTML,
                map = this._emoji;

            var key, image;
            for (var i in map) {
                key = map[i].key;
                image = this._image(i, key);

                // ç¬¬1ä¸ªåŒ¹é…çš„ï¼Œæ˜¯æ ‡ç­¾ï¼Œç¬¬äºŒä¸ªåŒ¹é…çš„ï¼Œæ˜¯icon
                html = html.replace(this._reg(key), function(str, match1, match2) {
                    return match1 ? match1 : match2 ? image : "";
                });
            }

            elem.innerHTML = html;
        },
        // å›æ”¶å†…å­˜
        destroy: function() {
            // é‡Šæ”¾å†…å­˜
            this._emoji = null;
            delete this._emoji;
        },
        // æ­£åˆ™çš„MAP
        _rmap: {},
        // è·å–å¯¹åº”çš„æ­£åˆ™
        _reg: function(key) {
            var reg = this._rmap[key];
            if (!reg) {
                // /(<[^>]*?[^ğŸ˜„]+?>)|(ğŸ˜„)/g
                // /(<[^>]*?>)|(x)/
                reg = this._rmap[key] = new RegExp("(<[^>]*?>)|(" + key + ")", "g");
            }
            return reg;
        },
        // ç»„è£…å›¾ç‰‡
        _image: function(src, name) {
            return imageTmp + path + src + '.png" alt="' + name + '" />';
        }
    };


    window[NAME] = emoji;

}(window, window.EMOJI_NAME || "ToEmoji");
